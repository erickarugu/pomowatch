import{helpers}from"./helpers.js";export const Timer={};Timer.timers=[];let pomowatch_settings=localStorage.getItem("pomowatch_settings");Timer.settings=pomowatch_settings?JSON.parse(pomowatch_settings):{timers:{pomodoro:25,short_break:5,long_break:10},auto_start_pomodoros:!1,auto_start_breaks:!1,long_break_interval:6,sound:!1},Timer.controls={paused:!1,running:!1,loop:!1,loop_count:0,on_break:!1},Timer.saveSettings=function(t){let e=t.get("pomodoro"),o=t.get("short_break"),r=t.get("long_break"),s=t.get("auto_start_breaks"),i=t.get("auto_start_pomodoros"),n=t.get("long_break_intervals"),m=t.get("sound");if(Timer.settings.timers={pomodoro:e,short_break:o,long_break:r},Timer.settings.auto_start_pomodoros=i,Timer.settings.auto_start_breaks=s,Timer.settings.long_break_interval=parseInt(n,10),Timer.settings.sound=m,localStorage.setItem("pomowatch_settings",JSON.stringify(Timer.settings)),!Timer.controls.running){const t=document.getElementById("timer");let e=60*Timer.settings.timers.pomodoro,o=Math.floor(e/60)<10?"0"+Math.floor(e/60):Math.floor(e/60),r=e%60<10?"0"+e%60:e%60;t.innerHTML=`${o}:${r}`}},Timer.clearTimers=function(){if(Timer.timers.length>0)for(var t=0;t<Timer.timers.length;t++)clearInterval(Timer.timers[t])},Timer.startTimer=function(t){let e="pomodoro"==t?Timer.settings.timers.pomodoro:"short"==t?Timer.settings.timers.short_break:Timer.settings.timers.long_break;e*=60,"pomodoro"==t&&"true"==Timer.settings.auto_start_breaks?Timer.controls.on_break=!0:Timer.controls.on_break=!1;const o=document.getElementById("timer"),r=document.getElementById("start-stop-button");let s=new Audio("../../assets/audios/door-bell.mp3"),i=new Audio("../../assets/audios/clock-tick.mp3");if(Timer.timers.length>0)for(var n=0;n<Timer.timers.length;n++)clearInterval(Timer.timers[n]);const m=setInterval((()=>{Timer.controls.paused||e--;let t=Math.floor(e/60)<10?"0"+Math.floor(e/60):Math.floor(e/60),n=e%60<10?"0"+e%60:e%60;o.innerHTML=`${t}:${n}`,document.title=`${t}:${n}`,"true"!=Timer.settings.sound||Timer.controls.paused||(i.currentTime=0,i.play()),e<=0&&(clearInterval(m),r.innerText="START",Timer.controls.running=!1,s.play(),Timer.controls.loop&&Timer.timerLoop(!1))}),1e3);Timer.timers.push(m),r.innerText="STOP",Timer.controls.running=!0},Timer.timerLoop=function(t){"true"==Timer.settings.auto_start_pomodoros&&(Timer.controls.loop=!0),Timer.controls.on_break?0!==Timer.controls.loop_count&&Timer.controls.loop_count%Timer.settings.long_break_interval==0?(Timer.startTimer("long"),helpers.updateDisplay("long")):(helpers.updateDisplay("short"),Timer.startTimer("short")):(t||Timer.controls.loop_count++,Timer.startTimer("pomodoro"),helpers.updateDisplay("pomodoro"))};
//# sourceMappingURL=timer.js.map